<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-local-binds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-matches #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hydra.TUI.Handlers</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Ord.html#Down"><span class="hs-identifier">Down</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">padLeft</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Brick</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Active</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PostTxError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">InternalWalletError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NotEnoughFuel</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reason</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Brick.Forms</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Form</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">formState</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">editShowableFieldWithValidate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">handleFormEvent</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newForm</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">radioField</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.UTxO</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#nub"><span class="hs-identifier">nub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-identifier">Event</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EvKey</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-identifier">Key</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vty</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.API.ClientInput</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ClientInput</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.API.ServerOutput</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ServerOutput</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TimedServerOutput</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain.CardanoClient</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoClient</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain.Direct.State</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.Client.html"><span class="hs-identifier">Hydra.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier">Client</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier">HydraEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsTx</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">balance</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger.Cardano</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mkSimpleTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Party</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Party</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Snapshot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Snapshot</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Forms.html"><span class="hs-identifier">Hydra.TUI.Forms</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Handlers.Global.html"><span class="hs-identifier">Hydra.TUI.Handlers.Global</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.TUI.Handlers.Global.html#handleVtyGlobalEvents"><span class="hs-identifier">handleVtyGlobalEvents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html"><span class="hs-identifier">Hydra.TUI.Logging.Handlers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier">report</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier">warn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html"><span class="hs-identifier">Hydra.TUI.Logging.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogMessage"><span class="hs-identifier">LogMessage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogState"><span class="hs-identifier">LogState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogVerbosity"><span class="hs-identifier">LogVerbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#Severity"><span class="hs-identifier">Severity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#logMessagesL"><span class="hs-identifier">logMessagesL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier">logVerbosityL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html"><span class="hs-identifier">Hydra.TUI.Model</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.Mtl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">use</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleEvent"><span class="hs-identifier hs-type">handleEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#RootState"><span class="hs-identifier hs-type">RootState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span id="handleEvent"><span class="annot"><span class="annottext">handleEvent :: CardanoClient
-&gt; Client Tx IO
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleEvent"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span id="local-6989586621679402591"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402591"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402592"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402592"><span class="hs-identifier hs-var">client</span></a></span></span><span> </span><span id="local-6989586621679402593"><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="annottext">(Event -&gt; EventM Name RootState ())
-&gt; ()
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name RootState ()
forall n s a w e.
(Event -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventVia"><span class="hs-identifier hs-var">handleVtyEventVia</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BrickEvent Name (HydraEvent Tx) -&gt; EventM Name RootState ())
-&gt; Event -&gt; EventM Name RootState ()
forall w e n s.
(BrickEvent w e -&gt; EventM n s ()) -&gt; Event -&gt; EventM n s ()
</span><a href="Hydra.TUI.Handlers.html#handleExtraHotkeys"><span class="hs-identifier hs-var">handleExtraHotkeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleEvent"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402591"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402592"><span class="hs-identifier hs-var">client</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name LogState) ()) RootState LogState
-&gt; EventM Name LogState () -&gt; EventM Name RootState ()
forall c.
LensLike' (Zoomed (EventM Name LogState) c) RootState LogState
-&gt; EventM Name LogState c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name LogState) ()) RootState LogState
(LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState LogState
</span><a href="Hydra.TUI.Model.html#logStateL"><span class="hs-identifier hs-var">logStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name LogState () -&gt; EventM Name RootState ())
-&gt; EventM Name LogState () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Event -&gt; EventM Name LogState ())
-&gt; () -&gt; BrickEvent Name (HydraEvent Tx) -&gt; EventM Name LogState ()
forall n s a w e.
(Event -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventVia"><span class="hs-identifier hs-var">handleVtyEventVia</span></a></span><span> </span><span class="annot"><span class="annottext">Event -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsLogState"><span class="hs-identifier hs-var">handleVtyEventsLogState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="annottext">(HydraEvent Tx -&gt; EventM Name RootState ())
-&gt; ()
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name RootState ()
forall e n s a w.
(e -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleAppEventVia"><span class="hs-identifier hs-var">handleAppEventVia</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleTick"><span class="hs-identifier hs-var">handleTick</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ConnectedState) ()) RootState ConnectedState
-&gt; EventM Name ConnectedState () -&gt; EventM Name RootState ()
forall c.
LensLike'
  (Zoomed (EventM Name ConnectedState) c) RootState ConnectedState
-&gt; EventM Name ConnectedState c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ConnectedState) ()) RootState ConnectedState
(ConnectedState
 -&gt; Focusing (StateT (EventState Name) IO) () ConnectedState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState ConnectedState
</span><a href="Hydra.TUI.Model.html#connectedStateL"><span class="hs-identifier hs-var">connectedStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ConnectedState () -&gt; EventM Name RootState ())
-&gt; EventM Name ConnectedState () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">(HydraEvent Tx -&gt; EventM Name ConnectedState ())
-&gt; ()
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name ConnectedState ()
forall e n s a w.
(e -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleAppEventVia"><span class="hs-identifier hs-var">handleAppEventVia</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name ConnectedState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnectedState"><span class="hs-identifier hs-var">handleHydraEventsConnectedState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name Connection) ()) ConnectedState Connection
-&gt; EventM Name Connection () -&gt; EventM Name ConnectedState ()
forall c.
LensLike'
  (Zoomed (EventM Name Connection) c) ConnectedState Connection
-&gt; EventM Name Connection c -&gt; EventM Name ConnectedState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name Connection) ()) ConnectedState Connection
(Connection
 -&gt; Focusing (StateT (EventState Name) IO) () Connection)
-&gt; ConnectedState
-&gt; Focusing (StateT (EventState Name) IO) () ConnectedState
Traversal' ConnectedState Connection
</span><a href="Hydra.TUI.Model.html#connectionL"><span class="hs-identifier hs-var">connectionL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name Connection () -&gt; EventM Name ConnectedState ())
-&gt; EventM Name Connection () -&gt; EventM Name ConnectedState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name Connection ()
forall w.
CardanoClient
-&gt; Client Tx IO
-&gt; BrickEvent w (HydraEvent Tx)
-&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleBrickEventsConnection"><span class="hs-identifier hs-var">handleBrickEventsConnection</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402591"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402592"><span class="hs-identifier hs-var">client</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name [LogMessage]) ()) RootState [LogMessage]
-&gt; EventM Name [LogMessage] () -&gt; EventM Name RootState ()
forall c.
LensLike'
  (Zoomed (EventM Name [LogMessage]) c) RootState [LogMessage]
-&gt; EventM Name [LogMessage] c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState LogState
</span><a href="Hydra.TUI.Model.html#logStateL"><span class="hs-identifier hs-var">logStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
 -&gt; RootState
 -&gt; Focusing (StateT (EventState Name) IO) () RootState)
-&gt; (([LogMessage]
     -&gt; Focusing (StateT (EventState Name) IO) () [LogMessage])
    -&gt; LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
-&gt; ([LogMessage]
    -&gt; Focusing (StateT (EventState Name) IO) () [LogMessage])
-&gt; RootState
-&gt; Focusing (StateT (EventState Name) IO) () RootState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([LogMessage]
 -&gt; Focusing (StateT (EventState Name) IO) () [LogMessage])
-&gt; LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState
Lens' LogState [LogMessage]
</span><a href="Hydra.TUI.Logging.Types.html#logMessagesL"><span class="hs-identifier hs-var">logMessagesL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM Name [LogMessage] () -&gt; EventM Name RootState ())
-&gt; EventM Name [LogMessage] () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">(HydraEvent Tx -&gt; EventM Name [LogMessage] ())
-&gt; ()
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name [LogMessage] ()
forall e n s a w.
(e -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleAppEventVia"><span class="hs-identifier hs-var">handleAppEventVia</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name [LogMessage] ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsInfo"><span class="hs-identifier hs-var">handleHydraEventsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">-- XXX: Global events must be handled as the very last step.</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-comment">-- Any `EventM` that decides to `Continue` would override the `Halt` decision.</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx) -&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleGlobalEvents"><span class="hs-identifier hs-var">handleGlobalEvents</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span id="local-6989586621679402096"><span id="local-6989586621679402097"><span id="local-6989586621679402098"><span id="local-6989586621679402099"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleExtraHotkeys"><span class="hs-identifier hs-type">handleExtraHotkeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679402096"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402097"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402098"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402099"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402098"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402099"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-59"></span><span id="handleExtraHotkeys"><span class="annot"><span class="annottext">handleExtraHotkeys :: forall w e n s.
(BrickEvent w e -&gt; EventM n s ()) -&gt; Event -&gt; EventM n s ()
</span><a href="Hydra.TUI.Handlers.html#handleExtraHotkeys"><span class="hs-identifier hs-var hs-var">handleExtraHotkeys</span></a></span></span><span> </span><span id="local-6989586621679402609"><span class="annot"><span class="annottext">BrickEvent w e -&gt; EventM n s ()
</span><a href="#local-6989586621679402609"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KDown</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BrickEvent w e -&gt; EventM n s ()
</span><a href="#local-6989586621679402609"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(BrickEvent w e -&gt; EventM n s ())
-&gt; BrickEvent w e -&gt; EventM n s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Event -&gt; BrickEvent w e
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">(Event -&gt; BrickEvent w e) -&gt; Event -&gt; BrickEvent w e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Modifier] -&gt; Event
</span><span class="hs-identifier hs-var">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Key
</span><span class="hs-identifier hs-var">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KUp</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BrickEvent w e -&gt; EventM n s ()
</span><a href="#local-6989586621679402609"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(BrickEvent w e -&gt; EventM n s ())
-&gt; BrickEvent w e -&gt; EventM n s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Event -&gt; BrickEvent w e
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">(Event -&gt; BrickEvent w e) -&gt; Event -&gt; BrickEvent w e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Modifier] -&gt; Event
</span><span class="hs-identifier hs-var">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KBackTab</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM n s ()
forall a. a -&gt; EventM n s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleTick"><span class="hs-identifier hs-type">handleTick</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#RootState"><span class="hs-identifier hs-type">RootState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span id="handleTick"><span class="annot"><span class="annottext">handleTick :: HydraEvent Tx -&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleTick"><span class="hs-identifier hs-var hs-var">handleTick</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span id="local-6989586621679402616"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402616"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Identity UTCTime) -&gt; RootState -&gt; Identity RootState
Lens' RootState UTCTime
</span><a href="Hydra.TUI.Model.html#nowL"><span class="hs-identifier hs-var">nowL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTCTime -&gt; Identity UTCTime) -&gt; RootState -&gt; Identity RootState)
-&gt; UTCTime -&gt; EventM Name RootState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402616"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name RootState ()
forall a. a -&gt; EventM Name RootState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span id="local-6989586621679402111"><span id="local-6989586621679402112"><span id="local-6989586621679402113"><span id="local-6989586621679402114"><span id="local-6989586621679402115"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleAppEventVia"><span class="hs-identifier hs-type">handleAppEventVia</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679402111"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402112"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402113"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402114"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402114"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679402115"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402111"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402112"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402113"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402114"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-70"></span><span id="handleAppEventVia"><span class="annot"><span class="annottext">handleAppEventVia :: forall e n s a w.
(e -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleAppEventVia"><span class="hs-identifier hs-var hs-var">handleAppEventVia</span></a></span></span><span> </span><span id="local-6989586621679402619"><span class="annot"><span class="annottext">e -&gt; EventM n s a
</span><a href="#local-6989586621679402619"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402620"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679402620"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">AppEvent</span></span><span> </span><span id="local-6989586621679402622"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679402622"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; EventM n s a
</span><a href="#local-6989586621679402619"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679402622"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="annottext">BrickEvent w e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; EventM n s a
forall a. a -&gt; EventM n s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679402620"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679402091"><span id="local-6989586621679402092"><span id="local-6989586621679402093"><span id="local-6989586621679402094"><span id="local-6989586621679402095"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventVia"><span class="hs-identifier hs-type">handleVtyEventVia</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402091"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402092"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402093"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402093"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679402094"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402095"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402091"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402092"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402093"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-75"></span><span id="handleVtyEventVia"><span class="annot"><span class="annottext">handleVtyEventVia :: forall n s a w e.
(Event -&gt; EventM n s a) -&gt; a -&gt; BrickEvent w e -&gt; EventM n s a
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventVia"><span class="hs-identifier hs-var hs-var">handleVtyEventVia</span></a></span></span><span> </span><span id="local-6989586621679402624"><span class="annot"><span class="annottext">Event -&gt; EventM n s a
</span><a href="#local-6989586621679402624"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402625"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679402625"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">VtyEvent</span></span><span> </span><span id="local-6989586621679402626"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402626"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; EventM n s a
</span><a href="#local-6989586621679402624"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402626"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="annottext">BrickEvent w e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; EventM n s a
forall a. a -&gt; EventM n s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679402625"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleGlobalEvents"><span class="hs-identifier hs-type">handleGlobalEvents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#RootState"><span class="hs-identifier hs-type">RootState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span id="handleGlobalEvents"><span class="annot"><span class="annottext">handleGlobalEvents :: BrickEvent Name (HydraEvent Tx) -&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleGlobalEvents"><span class="hs-identifier hs-var hs-var">handleGlobalEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">AppEvent</span></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name RootState ()
forall a. a -&gt; EventM Name RootState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">VtyEvent</span></span><span> </span><span id="local-6989586621679402627"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402627"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; EventM Name RootState ()
forall n s. Event -&gt; EventM n s ()
</span><a href="Hydra.TUI.Handlers.Global.html#handleVtyGlobalEvents"><span class="hs-identifier hs-var">handleVtyGlobalEvents</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402627"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name RootState ()
forall a. a -&gt; EventM Name RootState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnectedState"><span class="hs-identifier hs-type">handleHydraEventsConnectedState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ConnectedState"><span class="hs-identifier hs-type">ConnectedState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span id="handleHydraEventsConnectedState"><span class="annot"><span class="annottext">handleHydraEventsConnectedState :: HydraEvent Tx -&gt; EventM Name ConnectedState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnectedState"><span class="hs-identifier hs-var hs-var">handleHydraEventsConnectedState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="Hydra.Client.html#ClientConnected"><span class="hs-identifier hs-var">ClientConnected</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ConnectedState -&gt; Identity ConnectedState)
-&gt; ConnectedState -&gt; Identity ConnectedState
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((ConnectedState -&gt; Identity ConnectedState)
 -&gt; ConnectedState -&gt; Identity ConnectedState)
-&gt; ConnectedState -&gt; EventM Name ConnectedState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; ConnectedState
</span><a href="Hydra.TUI.Model.html#Connected"><span class="hs-identifier hs-var">Connected</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="Hydra.TUI.Model.html#emptyConnection"><span class="hs-identifier hs-var">emptyConnection</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="Hydra.Client.html#ClientDisconnected"><span class="hs-identifier hs-var">ClientDisconnected</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ConnectedState -&gt; Identity ConnectedState)
-&gt; ConnectedState -&gt; Identity ConnectedState
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((ConnectedState -&gt; Identity ConnectedState)
 -&gt; ConnectedState -&gt; Identity ConnectedState)
-&gt; ConnectedState -&gt; EventM Name ConnectedState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">ConnectedState
</span><a href="Hydra.TUI.Model.html#Disconnected"><span class="hs-identifier hs-var">Disconnected</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name ConnectedState ()
forall a. a -&gt; EventM Name ConnectedState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsHeadState"><span class="hs-identifier hs-type">handleVtyEventsHeadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#HeadState"><span class="hs-identifier hs-type">HeadState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="handleVtyEventsHeadState"><span class="annot"><span class="annottext">handleVtyEventsHeadState :: CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsHeadState"><span class="hs-identifier hs-var hs-var">handleVtyEventsHeadState</span></a></span></span><span> </span><span id="local-6989586621679402635"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402635"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402636"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402636"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402637"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402637"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679402638"><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679402638"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting HeadState HeadState HeadState
-&gt; EventM Name HeadState HeadState
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting HeadState HeadState HeadState
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679402638"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">HeadState
</span><a href="Hydra.TUI.Model.html#Idle"><span class="hs-identifier hs-var">Idle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402637"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'i'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name HeadState ()
forall a. IO a -&gt; EventM Name HeadState a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402636"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Init</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>      </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name HeadState ()
forall a. a -&gt; EventM Name HeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">HeadState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name HeadState ()
forall a. a -&gt; EventM Name HeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall c.
LensLike' (Zoomed (EventM Name ActiveLink) c) HeadState ActiveLink
-&gt; EventM Name ActiveLink c -&gt; EventM Name HeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
(ActiveLink
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveLink)
-&gt; HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState
Traversal' HeadState ActiveLink
</span><a href="Hydra.TUI.Model.html#activeLinkL"><span class="hs-identifier hs-var">activeLinkL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ActiveLink () -&gt; EventM Name HeadState ())
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveLink"><span class="hs-identifier hs-var">handleVtyEventsActiveLink</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402635"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402636"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402637"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveLink"><span class="hs-identifier hs-type">handleVtyEventsActiveLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span id="handleVtyEventsActiveLink"><span class="annot"><span class="annottext">handleVtyEventsActiveLink :: CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveLink"><span class="hs-identifier hs-var hs-var">handleVtyEventsActiveLink</span></a></span></span><span> </span><span id="local-6989586621679402645"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402646"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402646"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402647"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679402648"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402648"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting UTxO ActiveLink UTxO -&gt; EventM Name ActiveLink UTxO
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting UTxO ActiveLink UTxO
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ActiveHeadState) ())
  ActiveLink
  ActiveHeadState
-&gt; EventM Name ActiveHeadState () -&gt; EventM Name ActiveLink ()
forall c.
LensLike'
  (Zoomed (EventM Name ActiveHeadState) c) ActiveLink ActiveHeadState
-&gt; EventM Name ActiveHeadState c -&gt; EventM Name ActiveLink c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ActiveHeadState) ())
  ActiveLink
  ActiveHeadState
(ActiveHeadState
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState)
-&gt; ActiveLink
-&gt; Focusing (StateT (EventState Name) IO) () ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ActiveHeadState () -&gt; EventM Name ActiveLink ())
-&gt; EventM Name ActiveHeadState () -&gt; EventM Name ActiveLink ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO -&gt; UTxO -&gt; Event -&gt; EventM Name ActiveHeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveHeadState"><span class="hs-identifier hs-var">handleVtyEventsActiveHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402646"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402648"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveHeadState"><span class="hs-identifier hs-type">handleVtyEventsActiveHeadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveHeadState"><span class="hs-identifier hs-type">ActiveHeadState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span id="handleVtyEventsActiveHeadState"><span class="annot"><span class="annottext">handleVtyEventsActiveHeadState :: CardanoClient
-&gt; Client Tx IO -&gt; UTxO -&gt; Event -&gt; EventM Name ActiveHeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveHeadState"><span class="hs-identifier hs-var hs-var">handleVtyEventsActiveHeadState</span></a></span></span><span> </span><span id="local-6989586621679402652"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402652"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402653"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402654"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402654"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679402655"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402655"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name InitializingScreen) ())
  ActiveHeadState
  InitializingScreen
-&gt; EventM Name InitializingScreen ()
-&gt; EventM Name ActiveHeadState ()
forall c.
LensLike'
  (Zoomed (EventM Name InitializingScreen) c)
  ActiveHeadState
  InitializingScreen
-&gt; EventM Name InitializingScreen c
-&gt; EventM Name ActiveHeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(InitializingState
 -&gt; Focusing (StateT (EventState Name) IO) () InitializingState)
-&gt; ActiveHeadState
-&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState
Traversal' ActiveHeadState InitializingState
</span><a href="Hydra.TUI.Model.html#initializingStateL"><span class="hs-identifier hs-var">initializingStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingState
  -&gt; Focusing (StateT (EventState Name) IO) () InitializingState)
 -&gt; ActiveHeadState
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState)
-&gt; ((InitializingScreen
     -&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen)
    -&gt; InitializingState
    -&gt; Focusing (StateT (EventState Name) IO) () InitializingState)
-&gt; (InitializingScreen
    -&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen)
-&gt; ActiveHeadState
-&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(InitializingScreen
 -&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen)
-&gt; InitializingState
-&gt; Focusing (StateT (EventState Name) IO) () InitializingState
Lens' InitializingState InitializingScreen
</span><a href="Hydra.TUI.Model.html#initializingScreenL"><span class="hs-identifier hs-var">initializingScreenL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM Name InitializingScreen ()
 -&gt; EventM Name ActiveHeadState ())
-&gt; EventM Name InitializingScreen ()
-&gt; EventM Name ActiveHeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO -&gt; Event -&gt; EventM Name InitializingScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsInitializingScreen"><span class="hs-identifier hs-var">handleVtyEventsInitializingScreen</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402652"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name OpenScreen) ()) ActiveHeadState OpenScreen
-&gt; EventM Name OpenScreen () -&gt; EventM Name ActiveHeadState ()
forall c.
LensLike'
  (Zoomed (EventM Name OpenScreen) c) ActiveHeadState OpenScreen
-&gt; EventM Name OpenScreen c -&gt; EventM Name ActiveHeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name OpenScreen) ()) ActiveHeadState OpenScreen
(OpenScreen
 -&gt; Focusing (StateT (EventState Name) IO) () OpenScreen)
-&gt; ActiveHeadState
-&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState
Traversal' ActiveHeadState OpenScreen
</span><a href="Hydra.TUI.Model.html#openStateL"><span class="hs-identifier hs-var">openStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name OpenScreen () -&gt; EventM Name ActiveHeadState ())
-&gt; EventM Name OpenScreen () -&gt; EventM Name ActiveHeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO -&gt; UTxO -&gt; Event -&gt; EventM Name OpenScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsOpen"><span class="hs-identifier hs-var">handleVtyEventsOpen</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402652"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402654"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679402661"><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="#local-6989586621679402661"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting ActiveHeadState ActiveHeadState ActiveHeadState
-&gt; EventM Name ActiveHeadState ActiveHeadState
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting ActiveHeadState ActiveHeadState ActiveHeadState
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="#local-6989586621679402661"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#FanoutPossible"><span class="hs-identifier hs-var">FanoutPossible</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; Event -&gt; EventM Name ActiveHeadState ()
forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFanoutPossible"><span class="hs-identifier hs-var">handleVtyEventsFanoutPossible</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#Final"><span class="hs-identifier hs-var">Final</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; Event -&gt; EventM Name ActiveHeadState ()
forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFinal"><span class="hs-identifier hs-var">handleVtyEventsFinal</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">ActiveHeadState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name ActiveHeadState ()
forall a. a -&gt; EventM Name ActiveHeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsInitializingScreen"><span class="hs-identifier hs-type">handleVtyEventsInitializingScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#InitializingScreen"><span class="hs-identifier hs-type">InitializingScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="handleVtyEventsInitializingScreen"><span class="annot"><span class="annottext">handleVtyEventsInitializingScreen :: CardanoClient
-&gt; Client Tx IO -&gt; Event -&gt; EventM Name InitializingScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsInitializingScreen"><span class="hs-identifier hs-var hs-var">handleVtyEventsInitializingScreen</span></a></span></span><span> </span><span id="local-6989586621679402666"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402666"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402667"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402667"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402668"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; Identity InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingScreen -&gt; Identity InitializingScreen)
 -&gt; InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; InitializingScreen
</span><a href="Hydra.TUI.Model.html#ConfirmingAbort"><span class="hs-identifier hs-var">ConfirmingAbort</span></a></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
forall s e n. (s ~ Bool, n ~ Name) =&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#confirmRadioField"><span class="hs-identifier hs-var">confirmRadioField</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679402671"><span class="annot"><span class="annottext">InitializingScreen
</span><a href="#local-6989586621679402671"><span class="hs-identifier hs-var">initializingScreen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting InitializingScreen InitializingScreen InitializingScreen
-&gt; EventM Name InitializingScreen InitializingScreen
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting InitializingScreen InitializingScreen InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="#local-6989586621679402671"><span class="hs-identifier hs-var">initializingScreen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679402673"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402673"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTxO -&gt; EventM Name InitializingScreen UTxO
forall a. IO a -&gt; EventM Name InitializingScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UTxO -&gt; EventM Name InitializingScreen UTxO)
-&gt; IO UTxO -&gt; EventM Name InitializingScreen UTxO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><span class="hs-identifier hs-var">queryUTxOByAddress</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402666"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Address ShelleyAddr
</span><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-var">mkMyAddress</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402666"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402667"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; Identity InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingScreen -&gt; Identity InitializingScreen)
 -&gt; InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
-&gt; InitializingScreen
</span><a href="Hydra.TUI.Model.html#CommitMenu"><span class="hs-identifier hs-var">CommitMenu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
-&gt; Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
forall s e n.
(s ~ Map TxIn (TxOut CtxUTxO, Bool), n ~ Name) =&gt;
Map TxIn (TxOut CtxUTxO) -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#utxoCheckboxField"><span class="hs-identifier hs-var">utxoCheckboxField</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO)
 -&gt; Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
-&gt; Map TxIn (TxOut CtxUTxO)
-&gt; Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; Map TxIn (TxOut CtxUTxO)
forall out. UTxO' out -&gt; Map TxIn out
</span><span class="hs-identifier hs-var">UTxO.toMap</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402673"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#CommitMenu"><span class="hs-identifier hs-type">CommitMenu</span></a></span><span> </span><span id="local-6989586621679402679"><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
</span><a href="#local-6989586621679402679"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; Identity InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingScreen -&gt; Identity InitializingScreen)
 -&gt; InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402682"><span class="annot"><span class="annottext">u :: Map TxIn (TxOut CtxUTxO, Bool)
</span><a href="#local-6989586621679402682"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
-&gt; Map TxIn (TxOut CtxUTxO, Bool)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
</span><a href="#local-6989586621679402679"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402683"><span class="annot"><span class="annottext">commitUTxO :: UTxO
</span><a href="#local-6989586621679402683"><span class="hs-identifier hs-var hs-var">commitUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO) -&gt; UTxO
forall out. Map TxIn out -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO</span></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO) -&gt; UTxO)
-&gt; Map TxIn (TxOut CtxUTxO) -&gt; UTxO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((TxOut CtxUTxO, Bool) -&gt; Maybe (TxOut CtxUTxO))
-&gt; Map TxIn (TxOut CtxUTxO, Bool) -&gt; Map TxIn (TxOut CtxUTxO)
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapMaybe"><span class="hs-identifier hs-var">Map.mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679402686"><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679402686"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402687"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402687"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402687"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; Maybe (TxOut CtxUTxO)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679402686"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut CtxUTxO)
forall a. Maybe a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO, Bool)
</span><a href="#local-6989586621679402682"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name InitializingScreen ()
forall a. IO a -&gt; EventM Name InitializingScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name InitializingScreen ())
-&gt; IO () -&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; UTxO -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; UTxO -&gt; m ()
</span><a href="Hydra.Client.html#externalCommit"><span class="hs-identifier hs-var">externalCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402667"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402683"><span class="hs-identifier hs-var">commitUTxO</span></a></span><span>
</span><span id="line-136"></span><span>          </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; Identity InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingScreen -&gt; Identity InitializingScreen)
 -&gt; InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM
        Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
     ())
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
-&gt; EventM
     Name
     (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
     ()
-&gt; EventM Name InitializingScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM
        Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
     c)
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
-&gt; EventM
     Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name) c
-&gt; EventM Name InitializingScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM
        Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
     ())
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
(Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
-&gt; InitializingScreen
-&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen
Traversal'
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#commitMenuL"><span class="hs-identifier hs-var">commitMenuL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM
   Name
   (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
   ()
 -&gt; EventM Name InitializingScreen ())
-&gt; EventM
     Name
     (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
     ()
-&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM
     Name
     (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
     ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#ConfirmingAbort"><span class="hs-identifier hs-type">ConfirmingAbort</span></a></span><span> </span><span id="local-6989586621679402690"><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679402690"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; Identity InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingScreen -&gt; Identity InitializingScreen)
 -&gt; InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402691"><span class="annot"><span class="annottext">selected :: Bool
</span><a href="#local-6989586621679402691"><span class="hs-identifier hs-var hs-var">selected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; Bool
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679402690"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-144"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402691"><span class="hs-identifier hs-var">selected</span></a></span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name InitializingScreen ()
forall a. IO a -&gt; EventM Name InitializingScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name InitializingScreen ())
-&gt; IO () -&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402667"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Abort</span></span><span>
</span><span id="line-146"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; Identity InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingScreen -&gt; Identity InitializingScreen)
 -&gt; InitializingScreen -&gt; Identity InitializingScreen)
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  InitializingScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name InitializingScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) c)
  InitializingScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) c
-&gt; EventM Name InitializingScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  InitializingScreen
  (Form Bool (HydraEvent Tx) Name)
(Form Bool (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO) () (Form Bool (HydraEvent Tx) Name))
-&gt; InitializingScreen
-&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen
Traversal' InitializingScreen (Form Bool (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#confirmingAbortFormL"><span class="hs-identifier hs-var">confirmingAbortFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form Bool (HydraEvent Tx) Name) ()
 -&gt; EventM Name InitializingScreen ())
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsOpen"><span class="hs-identifier hs-type">handleVtyEventsOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#OpenScreen"><span class="hs-identifier hs-type">OpenScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="handleVtyEventsOpen"><span class="annot"><span class="annottext">handleVtyEventsOpen :: CardanoClient
-&gt; Client Tx IO -&gt; UTxO -&gt; Event -&gt; EventM Name OpenScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsOpen"><span class="hs-identifier hs-var hs-var">handleVtyEventsOpen</span></a></span></span><span> </span><span id="local-6989586621679402694"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402694"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402695"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402696"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402696"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679402697"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#ConfirmingClose"><span class="hs-identifier hs-var">ConfirmingClose</span></a></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
forall s e n. (s ~ Bool, n ~ Name) =&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#confirmRadioField"><span class="hs-identifier hs-var">confirmRadioField</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679402699"><span class="annot"><span class="annottext">OpenScreen
</span><a href="#local-6989586621679402699"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting OpenScreen OpenScreen OpenScreen
-&gt; EventM Name OpenScreen OpenScreen
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting OpenScreen OpenScreen OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="#local-6989586621679402699"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#ConfirmingClose"><span class="hs-identifier hs-type">ConfirmingClose</span></a></span><span> </span><span id="local-6989586621679402700"><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679402700"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402702"><span class="annot"><span class="annottext">selected :: Bool
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var hs-var">selected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; Bool
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679402700"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var">selected</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name OpenScreen ())
-&gt; IO () -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Close</span></span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Bool (HydraEvent Tx) Name)
(Form Bool (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO) () (Form Bool (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form Bool (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#confirmingCloseFormL"><span class="hs-identifier hs-var">confirmingCloseFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form Bool (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402705"><span class="annot"><span class="annottext">utxo' :: Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679402705"><span class="hs-identifier hs-var hs-var">utxo'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; VerificationKey PaymentKey -&gt; UTxO -&gt; Map TxIn (TxOut CtxUTxO)
</span><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-var">myAvailableUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402694"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402696"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-172"></span><span>          </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#SelectingUTxO"><span class="hs-identifier hs-var">SelectingUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
-&gt; Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
forall s e n.
(s ~ (TxIn, TxOut CtxUTxO), n ~ Name) =&gt;
Map TxIn (TxOut CtxUTxO) -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#utxoRadioField"><span class="hs-identifier hs-var">utxoRadioField</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679402705"><span class="hs-identifier hs-var">utxo'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingUTxO"><span class="hs-identifier hs-type">SelectingUTxO</span></a></span><span> </span><span id="local-6989586621679402712"><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679402712"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402713"><span class="annot"><span class="annottext">utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679402713"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutValue :: forall ctx. TxOut ctx -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402716"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402716"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
-&gt; (TxIn, TxOut CtxUTxO)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679402712"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span> </span><span id="local-6989586621679402718"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402718"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Lovelace
</span><span class="hs-identifier hs-var">selectLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402716"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402720"><span class="annot"><span class="annottext">enteringAmountForm :: Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679402720"><span class="hs-identifier hs-var hs-var">enteringAmountForm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402721"><span class="annot"><span class="annottext">field :: Integer -&gt; FormFieldState Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679402721"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' Integer Integer
-&gt; Name
-&gt; (Integer -&gt; Bool)
-&gt; Integer
-&gt; FormFieldState Integer (HydraEvent Tx) Name
forall n a s e.
(Ord n, Show n, Read a, Show a) =&gt;
Lens' s a -&gt; n -&gt; (a -&gt; Bool) -&gt; s -&gt; FormFieldState s e n
</span><span class="hs-identifier hs-var">editShowableFieldWithValidate</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; f Integer) -&gt; Integer -&gt; f Integer
forall a. a -&gt; a
Lens' Integer Integer
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;amount&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402723"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402723"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402723"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402723"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402718"><span class="hs-identifier hs-var">limit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Integer -&gt; FormFieldState Integer (HydraEvent Tx) Name]
-&gt; Integer -&gt; Form Integer (HydraEvent Tx) Name
forall s e n. [s -&gt; FormFieldState s e n] -&gt; s -&gt; Form s e n
</span><span class="hs-identifier hs-var">newForm</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; FormFieldState Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679402721"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402718"><span class="hs-identifier hs-var">limit</span></a></span><span>
</span><span id="line-183"></span><span>          </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#EnteringAmount"><span class="hs-identifier hs-type">EnteringAmount</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
utxoSelected :: (TxIn, TxOut CtxUTxO)
$sel:utxoSelected:OpenHome :: (TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679402713"><span class="hs-identifier hs-var hs-var">utxoSelected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name
enteringAmountForm :: Form Integer (HydraEvent Tx) Name
$sel:enteringAmountForm:OpenHome :: Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679402720"><span class="hs-identifier hs-var hs-var">enteringAmountForm</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
(Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal'
  OpenScreen (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingUTxOFormL"><span class="hs-identifier hs-var">selectingUTxOFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#EnteringAmount"><span class="hs-identifier hs-type">EnteringAmount</span></a></span><span> </span><span id="local-6989586621679402731"><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679402731"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span> </span><span id="local-6989586621679402732"><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679402732"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402733"><span class="annot"><span class="annottext">amountEntered :: Integer
</span><a href="#local-6989586621679402733"><span class="hs-identifier hs-var hs-var">amountEntered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name -&gt; Integer
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679402732"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402734"><span class="annot"><span class="annottext">ownAddress :: AddressInEra
</span><a href="#local-6989586621679402734"><span class="hs-identifier hs-var hs-var">ownAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra
forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402694"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402736"><span class="annot"><span class="annottext">field :: AddressInEra -&gt; FormFieldState AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679402736"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>                </span><span class="annot"><span class="annottext">Lens' AddressInEra AddressInEra
-&gt; [(AddressInEra, Name, Name)]
-&gt; AddressInEra
-&gt; FormFieldState AddressInEra (HydraEvent Tx) Name
forall n a s e.
(Ord n, Show n, Eq a) =&gt;
Lens' s a -&gt; [(a, n, Name)] -&gt; s -&gt; FormFieldState s e n
</span><span class="hs-identifier hs-var">radioField</span></span><span>
</span><span id="line-194"></span><span>                  </span><span class="annot"><span class="annottext">(AddressInEra -&gt; f AddressInEra) -&gt; AddressInEra -&gt; f AddressInEra
forall a. a -&gt; a
Lens' AddressInEra AddressInEra
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-195"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402738"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AddressInEra -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402738"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Name
forall a b. ConvertUtf8 a b =&gt; b -&gt; a
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Name) -&gt; ByteString -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402738"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679402738"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402738"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AddressInEra -&gt; Bool) -&gt; [AddressInEra] -&gt; [AddressInEra]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra -&gt; AddressInEra -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402734"><span class="hs-identifier hs-var">ownAddress</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AddressInEra] -&gt; [AddressInEra]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">[AddressInEra]
</span><a href="#local-6989586621679402743"><span class="hs-identifier hs-var">addresses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span>              </span><span id="local-6989586621679402743"><span class="annot"><span class="annottext">addresses :: [AddressInEra]
</span><a href="#local-6989586621679402743"><span class="hs-identifier hs-var hs-var">addresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; AddressInEra
forall {ctx}. TxOut ctx -&gt; AddressInEra
</span><a href="#local-6989586621679402744"><span class="hs-identifier hs-var">getRecipientAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO -&gt; AddressInEra)
-&gt; [TxOut CtxUTxO] -&gt; [AddressInEra]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO) -&gt; [TxOut CtxUTxO]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">Map.elems</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; Map TxIn (TxOut CtxUTxO)
forall out. UTxO' out -&gt; Map TxIn out
</span><span class="hs-identifier hs-var">UTxO.toMap</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402696"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>              </span><span id="local-6989586621679402744"><span class="annot"><span class="annottext">getRecipientAddress :: TxOut ctx -&gt; AddressInEra
</span><a href="#local-6989586621679402744"><span class="hs-identifier hs-var hs-var">getRecipientAddress</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutAddress :: forall {ctx}. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402748"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402748"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402748"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402749"><span class="annot"><span class="annottext">selectingRecipientForm :: Form AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679402749"><span class="hs-identifier hs-var hs-var">selectingRecipientForm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AddressInEra -&gt; FormFieldState AddressInEra (HydraEvent Tx) Name]
-&gt; AddressInEra -&gt; Form AddressInEra (HydraEvent Tx) Name
forall s e n. [s -&gt; FormFieldState s e n] -&gt; s -&gt; Form s e n
</span><span class="hs-identifier hs-var">newForm</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AddressInEra -&gt; FormFieldState AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679402736"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AddressInEra] -&gt; AddressInEra
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">Prelude.head</span></a></span><span> </span><span class="annot"><span class="annottext">[AddressInEra]
</span><a href="#local-6989586621679402743"><span class="hs-identifier hs-var">addresses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>          </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingRecipient"><span class="hs-identifier hs-type">SelectingRecipient</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
$sel:utxoSelected:OpenHome :: (TxIn, TxOut CtxUTxO)
utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="Hydra.TUI.Model.html#%24sel%3AutxoSelected%3AOpenHome"><span class="hs-identifier hs-var hs-var">utxoSelected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
amountEntered :: Integer
$sel:amountEntered:OpenHome :: Integer
</span><a href="#local-6989586621679402733"><span class="hs-identifier hs-var hs-var">amountEntered</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name
selectingRecipientForm :: Form AddressInEra (HydraEvent Tx) Name
$sel:selectingRecipientForm:OpenHome :: Form AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679402749"><span class="hs-identifier hs-var hs-var">selectingRecipientForm</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Integer (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Integer (HydraEvent Tx) Name)
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form Integer (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form Integer (HydraEvent Tx) Name)
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Integer (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Integer (HydraEvent Tx) Name)
(Form Integer (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form Integer (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form Integer (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#enteringAmountFormL"><span class="hs-identifier hs-var">enteringAmountFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form Integer (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingRecipient"><span class="hs-identifier hs-type">SelectingRecipient</span></a></span><span> </span><span id="local-6989586621679402755"><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679402755"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span> </span><span id="local-6989586621679402756"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402756"><span class="hs-identifier hs-var">amountEntered</span></a></span></span><span> </span><span id="local-6989586621679402757"><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679402757"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402758"><span class="annot"><span class="annottext">recipient :: AddressInEra
</span><a href="#local-6989586621679402758"><span class="hs-identifier hs-var hs-var">recipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name -&gt; AddressInEra
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679402757"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-209"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
-&gt; (AddressInEra, Value)
-&gt; SigningKey PaymentKey
-&gt; Either TxBodyError Tx
</span><span class="hs-identifier hs-var">mkSimpleTx</span></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679402755"><span class="hs-identifier hs-var">utxoSelected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402758"><span class="hs-identifier hs-var">recipient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; Lovelace -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">Lovelace</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679402756"><span class="hs-identifier hs-var">amountEntered</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679402760"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679402760"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; ClientInput Tx
forall tx. tx -&gt; ClientInput tx
</span><span class="hs-identifier hs-var">NewTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679402760"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>          </span><span class="annot"><span class="annottext">(OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; Identity OpenScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((OpenScreen -&gt; Identity OpenScreen)
 -&gt; OpenScreen -&gt; Identity OpenScreen)
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form AddressInEra (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form AddressInEra (HydraEvent Tx) Name)
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form AddressInEra (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form AddressInEra (HydraEvent Tx) Name)
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form AddressInEra (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form AddressInEra (HydraEvent Tx) Name)
(Form AddressInEra (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form AddressInEra (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form AddressInEra (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingRecipientFormL"><span class="hs-identifier hs-var">selectingRecipientFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679402160"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsFanoutPossible"><span class="hs-identifier hs-type">handleVtyEventsFanoutPossible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402160"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-218"></span><span id="handleVtyEventsFanoutPossible"><span class="annot"><span class="annottext">handleVtyEventsFanoutPossible :: forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFanoutPossible"><span class="hs-identifier hs-var hs-var">handleVtyEventsFanoutPossible</span></a></span></span><span> </span><span id="local-6989586621679402765"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402765"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402766"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402766"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402766"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name s ()
forall a. IO a -&gt; EventM Name s a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402765"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Fanout</span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name s ()
forall a. a -&gt; EventM Name s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="local-6989586621679402768"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsFinal"><span class="hs-identifier hs-type">handleVtyEventsFinal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402768"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-225"></span><span id="handleVtyEventsFinal"><span class="annot"><span class="annottext">handleVtyEventsFinal :: forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFinal"><span class="hs-identifier hs-var hs-var">handleVtyEventsFinal</span></a></span></span><span> </span><span id="local-6989586621679402771"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402771"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402772"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402772"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402772"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'i'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name s ()
forall a. IO a -&gt; EventM Name s a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402771"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Init</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name s ()
forall a. a -&gt; EventM Name s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnection"><span class="hs-identifier hs-type">handleHydraEventsConnection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span id="handleHydraEventsConnection"><span class="annot"><span class="annottext">handleHydraEventsConnection :: HydraEvent Tx -&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnection"><span class="hs-identifier hs-var hs-var">handleHydraEventsConnection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Greetings</span></span><span class="hs-special">{</span><span id="local-6989586621679402778"><span class="annot"><span class="annottext">Party
me :: Party
$sel:me:PeerConnected :: forall tx. ServerOutput tx -&gt; Party
</span><a href="#local-6989586621679402778"><span class="hs-identifier hs-var hs-var">me</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(IdentifiedState -&gt; Identity IdentifiedState)
-&gt; Connection -&gt; Identity Connection
Lens' Connection IdentifiedState
</span><a href="Hydra.TUI.Model.html#meL"><span class="hs-identifier hs-var">meL</span></a></span><span> </span><span class="annot"><span class="annottext">((IdentifiedState -&gt; Identity IdentifiedState)
 -&gt; Connection -&gt; Identity Connection)
-&gt; IdentifiedState -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Party -&gt; IdentifiedState
</span><a href="Hydra.TUI.Model.html#Identified"><span class="hs-identifier hs-var">Identified</span></a></span><span> </span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679402778"><span class="hs-identifier hs-var">me</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PeerConnected</span></span><span> </span><span id="local-6989586621679402783"><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679402783"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([NodeId] -&gt; Identity [NodeId])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [NodeId]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([NodeId] -&gt; Identity [NodeId])
 -&gt; Connection -&gt; Identity Connection)
-&gt; ([NodeId] -&gt; [NodeId]) -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402785"><span class="annot"><span class="annottext">[NodeId]
</span><a href="#local-6989586621679402785"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[NodeId] -&gt; [NodeId]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">([NodeId] -&gt; [NodeId]) -&gt; [NodeId] -&gt; [NodeId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[NodeId]
</span><a href="#local-6989586621679402785"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">[NodeId] -&gt; [NodeId] -&gt; [NodeId]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679402783"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PeerDisconnected</span></span><span> </span><span id="local-6989586621679402787"><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679402787"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([NodeId] -&gt; Identity [NodeId])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [NodeId]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([NodeId] -&gt; Identity [NodeId])
 -&gt; Connection -&gt; Identity Connection)
-&gt; ([NodeId] -&gt; [NodeId]) -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402788"><span class="annot"><span class="annottext">[NodeId]
</span><a href="#local-6989586621679402788"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[NodeId]
</span><a href="#local-6989586621679402788"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">[NodeId] -&gt; [NodeId] -&gt; [NodeId]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679402787"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679402789"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402789"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) Connection HeadState
-&gt; EventM Name HeadState () -&gt; EventM Name Connection ()
forall c.
LensLike' (Zoomed (EventM Name HeadState) c) Connection HeadState
-&gt; EventM Name HeadState c -&gt; EventM Name Connection c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) Connection HeadState
(HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
-&gt; Connection
-&gt; Focusing (StateT (EventState Name) IO) () Connection
Lens' Connection HeadState
</span><a href="Hydra.TUI.Model.html#headStateL"><span class="hs-identifier hs-var">headStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name HeadState () -&gt; EventM Name Connection ())
-&gt; EventM Name HeadState () -&gt; EventM Name Connection ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsHeadState"><span class="hs-identifier hs-var">handleHydraEventsHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402789"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsHeadState"><span class="hs-identifier hs-type">handleHydraEventsHeadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#HeadState"><span class="hs-identifier hs-type">HeadState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span id="handleHydraEventsHeadState"><span class="annot"><span class="annottext">handleHydraEventsHeadState :: HydraEvent Tx -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsHeadState"><span class="hs-identifier hs-var hs-var">handleHydraEventsHeadState</span></a></span></span><span> </span><span id="local-6989586621679402792"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402792"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402792"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402793"><span class="annot"><span class="annottext">UTCTime
time :: UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
</span><a href="#local-6989586621679402793"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsInitializing</span></span><span class="hs-special">{</span><span id="local-6989586621679402796"><span class="annot"><span class="annottext">[Party]
parties :: [Party]
$sel:parties:PeerConnected :: forall tx. ServerOutput tx -&gt; [Party]
</span><a href="#local-6989586621679402796"><span class="hs-identifier hs-var hs-var">parties</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402798"><span class="annot"><span class="annottext">HeadId
headId :: HeadId
$sel:headId:PeerConnected :: forall tx. ServerOutput tx -&gt; HeadId
</span><a href="#local-6989586621679402798"><span class="hs-identifier hs-var hs-var">headId</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">(HeadState -&gt; Identity HeadState)
-&gt; HeadState -&gt; Identity HeadState
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((HeadState -&gt; Identity HeadState)
 -&gt; HeadState -&gt; Identity HeadState)
-&gt; HeadState -&gt; EventM Name HeadState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">ActiveLink -&gt; HeadState
</span><a href="Hydra.TUI.Model.html#Active"><span class="hs-identifier hs-var">Active</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Party] -&gt; HeadId -&gt; ActiveLink
</span><a href="Hydra.TUI.Model.html#newActiveLink"><span class="hs-identifier hs-var">newActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Party] -&gt; [Party]
forall a. [a] -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">[Party]
</span><a href="#local-6989586621679402796"><span class="hs-identifier hs-var">parties</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HeadId
</span><a href="#local-6989586621679402798"><span class="hs-identifier hs-var">headId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402803"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsAborted</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">(HeadState -&gt; Identity HeadState)
-&gt; HeadState -&gt; Identity HeadState
forall a. a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">((HeadState -&gt; Identity HeadState)
 -&gt; HeadState -&gt; Identity HeadState)
-&gt; HeadState -&gt; EventM Name HeadState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">HeadState
</span><a href="Hydra.TUI.Model.html#Idle"><span class="hs-identifier hs-var">Idle</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name HeadState ()
forall a. a -&gt; EventM Name HeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall c.
LensLike' (Zoomed (EventM Name ActiveLink) c) HeadState ActiveLink
-&gt; EventM Name ActiveLink c -&gt; EventM Name HeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
(ActiveLink
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveLink)
-&gt; HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState
Traversal' HeadState ActiveLink
</span><a href="Hydra.TUI.Model.html#activeLinkL"><span class="hs-identifier hs-var">activeLinkL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ActiveLink () -&gt; EventM Name HeadState ())
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsActiveLink"><span class="hs-identifier hs-var">handleHydraEventsActiveLink</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402792"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsActiveLink"><span class="hs-identifier hs-type">handleHydraEventsActiveLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span id="handleHydraEventsActiveLink"><span class="annot"><span class="annottext">handleHydraEventsActiveLink :: HydraEvent Tx -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsActiveLink"><span class="hs-identifier hs-var hs-var">handleHydraEventsActiveLink</span></a></span></span><span> </span><span id="local-6989586621679402806"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402806"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402806"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Committed</span></span><span class="hs-special">{</span><span id="local-6989586621679402808"><span class="annot"><span class="annottext">Party
party :: Party
$sel:party:PeerConnected :: forall tx. ServerOutput tx -&gt; Party
</span><a href="#local-6989586621679402808"><span class="hs-identifier hs-var hs-var">party</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402810"><span class="annot"><span class="annottext">UTxOType Tx
utxo :: UTxOType Tx
$sel:utxo:PeerConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><a href="#local-6989586621679402810"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">Party -&gt; UTxO -&gt; EventM Name ActiveLink ()
forall n. Party -&gt; UTxO -&gt; EventM n ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#partyCommitted"><span class="hs-identifier hs-var">partyCommitted</span></a></span><span> </span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679402808"><span class="hs-identifier hs-var">party</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679402810"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402813"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsOpen</span></span><span class="hs-special">{</span><span id="local-6989586621679402815"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:PeerConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; ActiveHeadState
</span><a href="Hydra.TUI.Model.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402817"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SnapshotConfirmed</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:snapshot:PeerConnected :: forall tx. ServerOutput tx -&gt; Snapshot tx
</span><span class="hs-identifier hs-var">snapshot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span class="hs-special">{</span><span id="local-6989586621679402821"><span class="annot"><span class="annottext">UTxOType Tx
utxo :: UTxOType Tx
$sel:utxo:Snapshot :: forall tx. Snapshot tx -&gt; UTxOType tx
</span><a href="#local-6989586621679402821"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679402821"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402823"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsClosed</span></span><span class="hs-special">{</span><span id="local-6989586621679402825"><span class="annot"><span class="annottext">HeadId
$sel:headId:PeerConnected :: forall tx. ServerOutput tx -&gt; HeadId
headId :: HeadId
</span><span class="hs-identifier hs-var hs-var">headId</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402826"><span class="annot"><span class="annottext">SnapshotNumber
snapshotNumber :: SnapshotNumber
$sel:snapshotNumber:PeerConnected :: forall tx. ServerOutput tx -&gt; SnapshotNumber
</span><a href="#local-6989586621679402826"><span class="hs-identifier hs-var hs-var">snapshotNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402828"><span class="annot"><span class="annottext">UTCTime
contestationDeadline :: UTCTime
$sel:contestationDeadline:PeerConnected :: forall tx. ServerOutput tx -&gt; UTCTime
</span><a href="#local-6989586621679402828"><span class="hs-identifier hs-var hs-var">contestationDeadline</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:closedState:Initializing :: ClosedState
</span><a href="Hydra.TUI.Model.html#%24sel%3AclosedState%3AInitializing"><span class="hs-identifier hs-var">closedState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ClosedState"><span class="hs-identifier hs-type">ClosedState</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">UTCTime
contestationDeadline :: UTCTime
$sel:contestationDeadline:ClosedState :: UTCTime
</span><a href="#local-6989586621679402828"><span class="hs-identifier hs-var hs-var">contestationDeadline</span></a></span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402834"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadyToFanout</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#FanoutPossible"><span class="hs-identifier hs-var">FanoutPossible</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402836"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679402838"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:PeerConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679402838"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#Final"><span class="hs-identifier hs-var">Final</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name ActiveLink ()
forall a. a -&gt; EventM Name ActiveLink a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsInfo"><span class="hs-identifier hs-type">handleHydraEventsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span id="handleHydraEventsInfo"><span class="annot"><span class="annottext">handleHydraEventsInfo :: HydraEvent Tx -&gt; EventM Name [LogMessage] ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsInfo"><span class="hs-identifier hs-var hs-var">handleHydraEventsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402839"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsInitializing</span></span><span class="hs-special">{</span><span id="local-6989586621679402840"><span class="annot"><span class="annottext">[Party]
$sel:parties:PeerConnected :: forall tx. ServerOutput tx -&gt; [Party]
parties :: [Party]
</span><span class="hs-identifier hs-var hs-var">parties</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402841"><span class="annot"><span class="annottext">HeadId
$sel:headId:PeerConnected :: forall tx. ServerOutput tx -&gt; HeadId
headId :: HeadId
</span><span class="hs-identifier hs-var hs-var">headId</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402839"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head is initializing&quot;</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402842"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Committed</span></span><span class="hs-special">{</span><span id="local-6989586621679402843"><span class="annot"><span class="annottext">Party
$sel:party:PeerConnected :: forall tx. ServerOutput tx -&gt; Party
party :: Party
</span><span class="hs-identifier hs-var hs-var">party</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402844"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:PeerConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402842"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Party -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679402843"><span class="hs-identifier hs-var">party</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; committed &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Name
</span><span class="hs-identifier hs-var">renderValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tx. IsTx tx =&gt; UTxOType tx -&gt; ValueType tx
</span><span class="hs-identifier hs-var">balance</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><span class="annottext">UTxOType Tx
</span><a href="#local-6989586621679402844"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402846"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsOpen</span></span><span class="hs-special">{</span><span id="local-6989586621679402847"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:PeerConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402846"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head is now open!&quot;</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402848"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsAborted</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402848"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head aborted, back to square one.&quot;</span></span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402849"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SnapshotConfirmed</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:snapshot:PeerConnected :: forall tx. ServerOutput tx -&gt; Snapshot tx
</span><span class="hs-identifier hs-var">snapshot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span class="hs-special">{</span><span id="local-6989586621679402850"><span class="annot"><span class="annottext">SnapshotNumber
number :: SnapshotNumber
$sel:number:Snapshot :: forall tx. Snapshot tx -&gt; SnapshotNumber
</span><a href="#local-6989586621679402850"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402849"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Snapshot #&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="#local-6989586621679402850"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; confirmed.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402852"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CommandFailed</span></span><span class="hs-special">{</span><span id="local-6989586621679402854"><span class="annot"><span class="annottext">ClientInput Tx
clientInput :: ClientInput Tx
$sel:clientInput:PeerConnected :: forall tx. ServerOutput tx -&gt; ClientInput tx
</span><a href="#local-6989586621679402854"><span class="hs-identifier hs-var hs-var">clientInput</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402852"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Invalid command: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
</span><a href="#local-6989586621679402854"><span class="hs-identifier hs-var">clientInput</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402856"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsClosed</span></span><span class="hs-special">{</span><span id="local-6989586621679402857"><span class="annot"><span class="annottext">SnapshotNumber
$sel:snapshotNumber:PeerConnected :: forall tx. ServerOutput tx -&gt; SnapshotNumber
snapshotNumber :: SnapshotNumber
</span><span class="hs-identifier hs-var hs-var">snapshotNumber</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402856"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head closed with snapshot number &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="#local-6989586621679402857"><span class="hs-identifier hs-var">snapshotNumber</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402858"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxValid</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402858"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Transaction submitted successfully!&quot;</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402861"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxInvalid</span></span><span class="hs-special">{</span><span id="local-6989586621679402863"><span class="annot"><span class="annottext">Tx
transaction :: Tx
$sel:transaction:PeerConnected :: forall tx. ServerOutput tx -&gt; tx
</span><a href="#local-6989586621679402863"><span class="hs-identifier hs-var hs-var">transaction</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402865"><span class="annot"><span class="annottext">ValidationError
validationError :: ValidationError
$sel:validationError:PeerConnected :: forall tx. ServerOutput tx -&gt; ValidationError
</span><a href="#local-6989586621679402865"><span class="hs-identifier hs-var hs-var">validationError</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402861"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Transaction with id &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; TxIdType Tx
forall tx. IsTx tx =&gt; tx -&gt; TxIdType tx
</span><span class="hs-identifier hs-var">txId</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679402863"><span class="hs-identifier hs-var">transaction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; is not applicable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationError -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679402865"><span class="hs-identifier hs-var">validationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402868"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeadIsFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679402869"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:PeerConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402868"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head is finalized&quot;</span></span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402870"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InvalidInput</span></span><span class="hs-special">{</span><span id="local-6989586621679402872"><span class="annot"><span class="annottext">String
reason :: String
$sel:reason:PeerConnected :: forall tx. ServerOutput tx -&gt; String
</span><a href="#local-6989586621679402872"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402870"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Invalid input error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
forall a. ToText a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402872"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679402875"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PostTxOnChainFailed</span></span><span class="hs-special">{</span><span id="local-6989586621679402877"><span class="annot"><span class="annottext">PostTxError Tx
postTxError :: PostTxError Tx
$sel:postTxError:PeerConnected :: forall tx. ServerOutput tx -&gt; PostTxError tx
</span><a href="#local-6989586621679402877"><span class="hs-identifier hs-var hs-var">postTxError</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PostTxError Tx
</span><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">postTxError</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">PostTxError Tx
</span><span class="hs-identifier hs-var">NotEnoughFuel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402875"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Not enough Fuel. Please provide more to the internal wallet and try again.&quot;</span></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">InternalWalletError</span></span><span class="hs-special">{</span><span id="local-6989586621679402879"><span class="annot"><span class="annottext">Name
$sel:reason:NoSeedInput :: forall tx. PostTxError tx -&gt; Name
reason :: Name
</span><span class="hs-identifier hs-var hs-var">reason</span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402875"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402879"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><span class="annottext">PostTxError Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679402875"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;An error happened while trying to post a transaction on-chain: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PostTxError Tx -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PostTxError Tx
</span><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">postTxError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name [LogMessage] ()
forall a. a -&gt; EventM Name [LogMessage] a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span id="local-6989586621679402248"><span class="annot"><a href="Hydra.TUI.Handlers.html#partyCommitted"><span class="hs-identifier hs-type">partyCommitted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Party</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679402248"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-300"></span><span id="partyCommitted"><span class="annot"><span class="annottext">partyCommitted :: forall n. Party -&gt; UTxO -&gt; EventM n ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#partyCommitted"><span class="hs-identifier hs-var hs-var">partyCommitted</span></a></span></span><span> </span><span id="local-6989586621679402895"><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679402895"><span class="hs-identifier hs-var">party</span></a></span></span><span> </span><span id="local-6989586621679402896"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402896"><span class="hs-identifier hs-var">commit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM n InitializingState) ())
  ActiveLink
  InitializingState
-&gt; EventM n InitializingState () -&gt; EventM n ActiveLink ()
forall c.
LensLike'
  (Zoomed (EventM n InitializingState) c)
  ActiveLink
  InitializingState
-&gt; EventM n InitializingState c -&gt; EventM n ActiveLink c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ActiveHeadState
 -&gt; Zoomed (EventM n InitializingState) () ActiveHeadState)
-&gt; ActiveLink -&gt; Zoomed (EventM n InitializingState) () ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState
  -&gt; Zoomed (EventM n InitializingState) () ActiveHeadState)
 -&gt; ActiveLink -&gt; Zoomed (EventM n InitializingState) () ActiveLink)
-&gt; ((InitializingState
     -&gt; Zoomed (EventM n InitializingState) () InitializingState)
    -&gt; ActiveHeadState
    -&gt; Zoomed (EventM n InitializingState) () ActiveHeadState)
-&gt; LensLike'
     (Zoomed (EventM n InitializingState) ())
     ActiveLink
     InitializingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(InitializingState
 -&gt; Zoomed (EventM n InitializingState) () InitializingState)
-&gt; ActiveHeadState
-&gt; Zoomed (EventM n InitializingState) () ActiveHeadState
Traversal' ActiveHeadState InitializingState
</span><a href="Hydra.TUI.Model.html#initializingStateL"><span class="hs-identifier hs-var">initializingStateL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM n InitializingState () -&gt; EventM n ActiveLink ())
-&gt; EventM n InitializingState () -&gt; EventM n ActiveLink ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">([Party] -&gt; Identity [Party])
-&gt; InitializingState -&gt; Identity InitializingState
Lens' InitializingState [Party]
</span><a href="Hydra.TUI.Model.html#remainingPartiesL"><span class="hs-identifier hs-var">remainingPartiesL</span></a></span><span> </span><span class="annot"><span class="annottext">(([Party] -&gt; Identity [Party])
 -&gt; InitializingState -&gt; Identity InitializingState)
-&gt; ([Party] -&gt; [Party]) -&gt; EventM n InitializingState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Party] -&gt; [Party] -&gt; [Party]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679402895"><span class="hs-identifier hs-var">party</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; (UTxO -&gt; UTxO) -&gt; EventM n ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; UTxO -&gt; UTxO
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679402896"><span class="hs-identifier hs-var">commit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span id="local-6989586621679402117"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleBrickEventsConnection"><span class="hs-identifier hs-type">handleBrickEventsConnection</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679402117"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-310"></span><span id="handleBrickEventsConnection"><span class="annot"><span class="annottext">handleBrickEventsConnection :: forall w.
CardanoClient
-&gt; Client Tx IO
-&gt; BrickEvent w (HydraEvent Tx)
-&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleBrickEventsConnection"><span class="hs-identifier hs-var hs-var">handleBrickEventsConnection</span></a></span></span><span> </span><span id="local-6989586621679402899"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402899"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402900"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402900"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402901"><span class="annot"><span class="annottext">BrickEvent w (HydraEvent Tx)
</span><a href="#local-6989586621679402901"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BrickEvent w (HydraEvent Tx)
</span><a href="#local-6989586621679402901"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">AppEvent</span></span><span> </span><span id="local-6989586621679402902"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402902"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnection"><span class="hs-identifier hs-var">handleHydraEventsConnection</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679402902"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">VtyEvent</span></span><span> </span><span id="local-6989586621679402903"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402903"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsConnection"><span class="hs-identifier hs-var">handleVtyEventsConnection</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402899"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402900"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402903"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="annottext">BrickEvent w (HydraEvent Tx)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name Connection ()
forall a. a -&gt; EventM Name Connection a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsConnection"><span class="hs-identifier hs-type">handleVtyEventsConnection</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span id="handleVtyEventsConnection"><span class="annot"><span class="annottext">handleVtyEventsConnection :: CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsConnection"><span class="hs-identifier hs-var hs-var">handleVtyEventsConnection</span></a></span></span><span> </span><span id="local-6989586621679402905"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402905"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402906"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402906"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679402907"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402907"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) Connection HeadState
-&gt; EventM Name HeadState () -&gt; EventM Name Connection ()
forall c.
LensLike' (Zoomed (EventM Name HeadState) c) Connection HeadState
-&gt; EventM Name HeadState c -&gt; EventM Name Connection c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) Connection HeadState
(HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
-&gt; Connection
-&gt; Focusing (StateT (EventState Name) IO) () Connection
Lens' Connection HeadState
</span><a href="Hydra.TUI.Model.html#headStateL"><span class="hs-identifier hs-var">headStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name HeadState () -&gt; EventM Name Connection ())
-&gt; EventM Name HeadState () -&gt; EventM Name Connection ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsHeadState"><span class="hs-identifier hs-var">handleVtyEventsHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402905"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402906"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679402907"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsLogState"><span class="hs-identifier hs-type">handleVtyEventsLogState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogState"><span class="hs-identifier hs-type">LogState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span id="handleVtyEventsLogState"><span class="annot"><span class="annottext">handleVtyEventsLogState :: Event -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsLogState"><span class="hs-identifier hs-var hs-var">handleVtyEventsLogState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-var">scroll</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Up</span></span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-var">scroll</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Down</span></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'h'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LogVerbosity -&gt; Identity LogVerbosity)
-&gt; LogState -&gt; Identity LogState
Lens' LogState LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier hs-var">logVerbosityL</span></a></span><span> </span><span class="annot"><span class="annottext">((LogVerbosity -&gt; Identity LogVerbosity)
 -&gt; LogState -&gt; Identity LogState)
-&gt; LogVerbosity -&gt; EventM Name LogState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LogVerbosity -&gt; Identity LogVerbosity)
-&gt; LogState -&gt; Identity LogState
Lens' LogState LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier hs-var">logVerbosityL</span></a></span><span> </span><span class="annot"><span class="annottext">((LogVerbosity -&gt; Identity LogVerbosity)
 -&gt; LogState -&gt; Identity LogState)
-&gt; LogVerbosity -&gt; EventM Name LogState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Short"><span class="hs-identifier hs-var">Short</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name LogState ()
forall a. a -&gt; EventM Name LogState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- View</span><span>
</span><span id="line-333"></span><span class="hs-comment">--</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-type">scroll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Direction</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogState"><span class="hs-identifier hs-type">LogState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span id="scroll"><span class="annot"><span class="annottext">scroll :: Direction -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-var hs-var">scroll</span></a></span></span><span> </span><span id="local-6989586621679402913"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679402913"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679402914"><span class="annot"><span class="annottext">LogVerbosity
</span><a href="#local-6989586621679402914"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting LogVerbosity LogState LogVerbosity
-&gt; EventM Name LogState LogVerbosity
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting LogVerbosity LogState LogVerbosity
Lens' LogState LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier hs-var">logVerbosityL</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="#local-6989586621679402914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402915"><span class="annot"><span class="annottext">vp :: ViewportScroll Name
</span><a href="#local-6989586621679402915"><span class="hs-identifier hs-var hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ViewportScroll Name
forall n. n -&gt; ViewportScroll n
</span><span class="hs-identifier hs-var">viewportScroll</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hydra.TUI.Model.html#fullFeedbackViewportName"><span class="hs-identifier hs-var">fullFeedbackViewportName</span></a></span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><span class="annottext">ViewportScroll Name -&gt; forall s. Direction -&gt; EventM Name s ()
forall n. ViewportScroll n -&gt; forall s. Direction -&gt; EventM n s ()
</span><span class="hs-identifier hs-var">vScrollPage</span></span><span> </span><span class="annot"><span class="annottext">ViewportScroll Name
</span><a href="#local-6989586621679402915"><span class="hs-identifier hs-var">vp</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679402913"><span class="hs-identifier hs-var">direction</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Short"><span class="hs-identifier hs-var">Short</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402919"><span class="annot"><span class="annottext">vp :: ViewportScroll Name
</span><a href="#local-6989586621679402919"><span class="hs-identifier hs-var hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ViewportScroll Name
forall n. n -&gt; ViewportScroll n
</span><span class="hs-identifier hs-var">viewportScroll</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hydra.TUI.Model.html#shortFeedbackViewportName"><span class="hs-identifier hs-var">shortFeedbackViewportName</span></a></span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">ViewportScroll Name -&gt; forall s. Direction -&gt; EventM Name s ()
forall n. ViewportScroll n -&gt; forall s. Direction -&gt; EventM n s ()
</span><span class="hs-identifier hs-var">hScrollPage</span></span><span> </span><span class="annot"><span class="annottext">ViewportScroll Name
</span><a href="#local-6989586621679402919"><span class="hs-identifier hs-var">vp</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679402913"><span class="hs-identifier hs-var">direction</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-type">myAvailableUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxUTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span id="myAvailableUTxO"><span class="annot"><span class="annottext">myAvailableUTxO :: NetworkId
-&gt; VerificationKey PaymentKey -&gt; UTxO -&gt; Map TxIn (TxOut CtxUTxO)
</span><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-var hs-var">myAvailableUTxO</span></a></span></span><span> </span><span id="local-6989586621679402922"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679402922"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679402923"><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621679402923"><span class="hs-identifier hs-var">vk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679402924"><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679402924"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402925"><span class="annot"><span class="annottext">myAddress :: AddressInEra
</span><a href="#local-6989586621679402925"><span class="hs-identifier hs-var hs-var">myAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra
forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679402922"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621679402923"><span class="hs-identifier hs-var">vk</span></a></span><span>
</span><span id="line-348"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO -&gt; Bool)
-&gt; Map TxIn (TxOut CtxUTxO) -&gt; Map TxIn (TxOut CtxUTxO)
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">Map.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutAddress :: forall {ctx}. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402927"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402927"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402927"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra -&gt; AddressInEra -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679402925"><span class="hs-identifier hs-var">myAddress</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679402924"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-type">mkMyAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Address</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddr</span></span><span>
</span><span id="line-351"></span><span id="mkMyAddress"><span class="annot"><span class="annottext">mkMyAddress :: CardanoClient -&gt; Client Tx IO -&gt; Address ShelleyAddr
</span><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-var hs-var">mkMyAddress</span></a></span></span><span> </span><span id="local-6989586621679402928"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402928"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679402929"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402929"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><span class="annottext">NetworkId
-&gt; PaymentCredential
-&gt; StakeAddressReference
-&gt; Address ShelleyAddr
</span><span class="hs-identifier hs-var">makeShelleyAddress</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679402928"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash PaymentKey -&gt; PaymentCredential
</span><span class="hs-identifier hs-var">PaymentCredentialByKey</span></span><span> </span><span class="annot"><span class="annottext">(Hash PaymentKey -&gt; PaymentCredential)
-&gt; (VerificationKey PaymentKey -&gt; Hash PaymentKey)
-&gt; VerificationKey PaymentKey
-&gt; PaymentCredential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey -&gt; Hash PaymentKey
forall keyrole.
Key keyrole =&gt;
VerificationKey keyrole -&gt; Hash keyrole
</span><span class="hs-identifier hs-var">verificationKeyHash</span></span><span> </span><span class="annot"><span class="annottext">(VerificationKey PaymentKey -&gt; PaymentCredential)
-&gt; VerificationKey PaymentKey -&gt; PaymentCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/g7is9c8iy7mij0yvra8lrlqi9y5mmkkj-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679402929"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">StakeAddressReference
</span><span class="hs-identifier hs-var">NoStakeAddress</span></span><span>
</span><span id="line-356"></span></pre></body></html>